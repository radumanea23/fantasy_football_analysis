<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Analytics – Power Rankings Trend</title>
    <link rel="stylesheet" href="./styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <nav class="nav">
      <div class="nav-inner">
        <div class="brand">Fantasy League</div>
        <a href="./power-rankings.html">Power Rankings</a>
        <a href="./matchups.html">Matchups</a>
        <a href="./analytics.html">Analytics</a>
        <div class="spacer"></div>
        <span class="badge">2025 • Week 1</span>
      </div>
    </nav>
    <div class="container">
      <div class="card">
        <h1 class="title">Power Rankings – Trend</h1>
        <p class="muted">Line chart: x = teams, y = week, value = rank position</p>
        <canvas id="chart" height="120"></canvas>
      </div>
    </div>
    <script>
      async function loadData() {
        // For now we only have week 1; structure allows future weeks appended
        const resTeams = await fetch('./data/teams.json');
        const teamsJson = await resTeams.json();
        const resW1 = await fetch('./data/2025/week1/power_rankings.json');
        const w1 = await resW1.json();

        const labels = w1.rankings
          .slice()
          .sort((a,b) => a.rank - b.rank)
          .map(r => r.team_name);

        // Build one dataset for week 1 using rank as value
        const week1Data = w1.rankings
          .slice()
          .sort((a,b) => a.rank - b.rank)
          .map(r => r.rank);

        const ctx = document.getElementById('chart').getContext('2d');
        const chart = new Chart(ctx, {
          type: 'line',
          data: {
            labels,
            datasets: [
              {
                label: 'Week 1 Rank',
                data: week1Data,
                tension: 0.35,
                borderColor: '#4F46E5',
                backgroundColor: 'rgba(79,70,229,0.25)',
                pointRadius: 4,
                pointHoverRadius: 6,
              },
            ],
          },
          options: {
            responsive: true,
            plugins: {
              legend: { labels: { color: '#C7D2FE' } },
              tooltip: { mode: 'index', intersect: false },
            },
            scales: {
              x: {
                ticks: { color: '#9AA5B1' },
                grid: { color: 'rgba(255,255,255,0.06)' },
              },
              y: {
                reverse: false, // smaller rank is better; display natural ascending but annotate
                ticks: { color: '#9AA5B1', stepSize: 1 },
                grid: { color: 'rgba(255,255,255,0.06)' },
                title: { display: true, text: 'Rank', color: '#9AA5B1' },
              },
            },
          },
        });
      }
      loadData();
    </script>
  </body>
  </html>


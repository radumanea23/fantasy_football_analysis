<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Matchup Predictions ‚Äì 2025 Week 1</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <nav class="nav">
      <div class="nav-inner">
        <div class="brand">Sean Farrell's Carpool</div>
        <a href="./power-rankings.html">Power Rankings</a>
        <a href="./matchups.html">Matchups</a>
        <a href="./analytics.html">Analytics</a>
        <div class="spacer"></div>
        <span class="badge">2025 ‚Ä¢ Week 1</span>
        <button id="theme-toggle" class="btn" aria-label="Toggle theme" title="Toggle theme">‚òÄÔ∏è</button>
      </div>
    </nav>
    <div class="container">
      <div class="card">
        <h1 class="title">Weekly Matchup Predictions</h1>
        <p class="muted">Predicted winners and reasoning</p>
        <div id="spicy" class="card" style="margin-bottom:16px; display:none;">
          <div class="title" style="display:flex;align-items:center;gap:10px;margin:0 0 8px 0;">
            <span>üå∂Ô∏è Spicy Matchup of the Week</span>
          </div>
          <div id="spicy-reason" class="muted"></div>
        </div>
        <div id="matchups-list" class="grid" style="grid-template-columns:1fr; gap:12px;"></div>
      </div>
    </div>
    <script>
      (function initTheme(){
        const stored = localStorage.getItem('theme') || 'light';
        if (stored === 'dark') document.documentElement.setAttribute('data-theme','dark');
        const btn = document.getElementById('theme-toggle');
        const update = () => { btn.textContent = document.documentElement.getAttribute('data-theme') === 'dark' ? 'üåô' : '‚òÄÔ∏è'; };
        update();
        btn.addEventListener('click', () => {
          const curr = document.documentElement.getAttribute('data-theme');
          const next = curr === 'dark' ? null : 'dark';
          if (next) document.documentElement.setAttribute('data-theme', next); else document.documentElement.removeAttribute('data-theme');
          localStorage.setItem('theme', next ? 'dark' : 'light');
          update();
        });
      })();
    </script>
    <script>
      async function loadPredictions() {
        const season = 2025; const week = 1;
        const [teamsRes, prRes, predRes] = await Promise.all([
          fetch('./data/teams.json'),
          fetch(`./data/${season}/week${week}/power_rankings.json`),
          fetch(`./data/${season}/week${week}/matchup_predictions.json`),
        ]);
        const teams = await teamsRes.json();
        const pr = await prRes.json();
        const preds = await predRes.json();

        const teamByRoster = new Map(teams.teams.map(t => [t.roster_id, t]));
        const list = document.getElementById('matchups-list');
        list.innerHTML = '';

        // Spicy matchup highlight
        if (preds.spicy_matchup) {
          const s = preds.spicy_matchup;
          const spicy = document.getElementById('spicy');
          const reason = document.getElementById('spicy-reason');
          spicy.style.display = 'block';
          reason.textContent = s.why || '';
        }

        (preds.predictions || []).forEach(p => {
          const home = teamByRoster.get(p.home_roster_id) || { team_name: `Team ${p.home_roster_id}`, avatar_url: '' };
          const away = teamByRoster.get(p.away_roster_id) || { team_name: `Team ${p.away_roster_id}`, avatar_url: '' };
          const winner = p.predicted_winner_roster_id === p.home_roster_id ? home.team_name : away.team_name;
          const card = document.createElement('div');
          card.className = 'card';
          card.innerHTML = `
            <div style="display:flex;align-items:center;gap:12px;">
              <img class="rank-avatar" src="${home.avatar_url||''}" alt="home" onerror="this.style.display='none'"/>
              <div style="font-weight:600;">${home.team_name}</div>
              <div class="muted" style="margin:0 8px;">vs</div>
              <img class="rank-avatar" src="${away.avatar_url||''}" alt="away" onerror="this.style.display='none'"/>
              <div style="font-weight:600;">${away.team_name}</div>
            </div>
            <div style="margin-top:8px;">
              <div><strong>Predicted Winner:</strong> ${winner}</div>
              <div class="muted" style="margin-top:6px;">${p.reasoning || ''}</div>
            </div>
          `;
          list.appendChild(card);
        });
      }
      loadPredictions();
    </script>
    <footer class="footer">
      <div class="footer-inner">
        <div class="muted">¬© 2025 Sean Farrell's Carpool</div>
        <div class="footer-links">
          <a href="https://www.hudl.com/profile/8700482/Dominic-Quigley" target="_blank" rel="noopener noreferrer">Dom's huddle highlights</a>
          <a href="https://github.com/radumanea23/fantasy_football_analysis" target="_blank" rel="noopener noreferrer">Github</a>
        </div>
      </div>
    </footer>
  </body>
  </html>

